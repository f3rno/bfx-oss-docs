<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width,initial-scale=1"><meta charset="utf-8"><link rel="stylesheet" type="text/css" href="css/normalize.css"><link rel="stylesheet" type="text/css" href="css/perfect-scrollbar.css"><link rel="stylesheet" type="text/css" href="css/highlightjs/night-owl.css"><link rel="stylesheet" type="text/css" href="index.css"><title>API Reference | bfx-hf-models</title></head><body><div id="bfx-oss-docs-side-bar"><div id="bfx-oss-docs-side-bar__header"><img src="img/bfx-logo-bg-white.png" alt="Bitfinex" height="63"></div><ul><li><a href="index.html"><p>Home</p></a></li><li><a href="page_md_render_test.html"><p>Markdown Render Test</p></a></li><li><a href="page_libraries_bitfinex_api_py_README.html"><img src="svg/icons/python.svg"><p>bitfinex-api-py</p></a></li><li><a href="page_libraries_bfx_hf_strategy_py_README.html"><img src="svg/icons/python.svg"><p>bfx-hf-strategy-py</p></a></li><li><a href="page_libraries_bfx_hf_indicators_py_README.html"><img src="svg/icons/python.svg"><p>bfx-hf-indicators-py</p></a></li><li><a href="page_libraries_bitfinex_api_go_README.html"><img src="svg/icons/go.svg"><p>bitfinex-api-go</p></a></li><li><a href="page_libraries_bfxfixgw_README.html"><img src="svg/icons/go.svg"><p>bfxfixgw</p></a></li><li><a href="page_libraries_bitfinex_api_rb_README.html"><img src="svg/icons/ruby.svg"><p>bitfinex-api-rb</p></a></li><li><a href="page_libraries_bitfinex_api_node_README.html"><img src="svg/icons/nodejs_small.svg"><p>bitfinex-api-node</p></a></li><li><a href="page_libraries_bfx_api_mock_srv_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-mock-srv</p></a></li><li><a href="page_libraries_bfx_api_node_core_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-core</p></a></li><li><a href="page_libraries_bfx_api_node_models_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-models</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_example_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-example</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_managed_candles_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-managed-candles</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_managed_ob_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-managed-ob</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_ob_checksum_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-ob-checksum</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_seq_audit_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-seq-audit</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_wd_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-wd</p></a></li><li><a href="page_libraries_bfx_api_node_rest_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-rest</p></a></li><li><a href="page_libraries_bfx_api_node_util_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-util</p></a></li><li><a href="page_libraries_bfx_api_node_ws1_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-ws1</p></a></li><li><a href="page_libraries_bfx_hf_backtest_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-backtest</p></a></li><li><a href="page_libraries_bfx_hf_chart_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-chart</p></a></li><li><a href="page_libraries_bfx_hf_data_server_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-data-server</p></a></li><li><a href="page_libraries_bfx_hf_ext_plugin_bitfinex_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-ext-plugin-bitfinex</p></a></li><li><a href="page_libraries_bfx_hf_ext_plugin_dummy_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-ext-plugin-dummy</p></a></li><li><a href="page_libraries_bfx_hf_indicators_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-indicators</p></a></li><li class="active"><a href="page_libraries_bfx_hf_models_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models</p></a><ul><li><a href="page_libraries_bfx_hf_models_README.html"><p>- README</p></a></li><li class="active"><a href="page_libraries_bfx_hf_models_reference.html"><p>- API Reference</p></a></li></ul></li><li><a href="page_libraries_bfx_hf_models_adapter_lowdb_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-lowdb</p></a></li><li><a href="page_libraries_bfx_hf_models_adapter_sql_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-sql</p></a></li><li><a href="page_libraries_bfx_hf_models_adapter_template_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-template</p></a></li><li><a href="page_libraries_bfx_hf_algo_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-algo</p></a></li><li><a href="page_libraries_bfx_hf_server_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-server</p></a></li><li><a href="page_libraries_bfx_hf_strategy_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-strategy</p></a></li><li><a href="page_libraries_bfx_hf_strategy_exec_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-strategy-exec</p></a></li><li><a href="page_libraries_bfx_hf_ui_config_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-ui-config</p></a></li><li><a href="page_libraries_bfx_hf_util_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-util</p></a></li><li><a href="page_libraries_bfx_ws2_api_audit_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-ws2-api-audit</p></a></li><li><a href="page_libraries_cbq_js_README.html"><img src="svg/icons/nodejs_small.svg"><p>cbq-js</p></a></li><li><a href="page_libraries_caron_README.html"><img src="svg/icons/nodejs_small.svg"><p>caron</p></a></li><li><a href="page_libraries_eos_name_verify_README.html"><img src="svg/icons/nodejs_small.svg"><p>eos-name-verify</p></a></li><li><a href="page_libraries_grenache_browser_http_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-browser-http</p></a></li><li><a href="page_libraries_grenache_grape_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-grape</p></a></li><li><a href="page_libraries_grenache_nodejs_base_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-base</p></a></li><li><a href="page_libraries_grenache_nodejs_http_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-http</p></a></li><li><a href="page_libraries_grenache_nodejs_link_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-link</p></a></li><li><a href="page_libraries_grenache_nodejs_utp_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-utp</p></a></li><li><a href="page_libraries_grenache_nodejs_ws_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-ws</p></a></li><li><a href="page_libraries_grenache_nodejs_ws_tls_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-ws-tls</p></a></li><li><a href="page_libraries_lib_js_util_currencies_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-currencies</p></a></li><li><a href="page_libraries_lib_js_util_math_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-math</p></a></li><li><a href="page_libraries_lib_js_util_number_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-number</p></a></li><li><a href="page_libraries_lib_js_util_symbol_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-symbol</p></a></li><li><a href="page_libraries_smidgen_README.html"><img src="svg/icons/nodejs_small.svg"><p>smidgen</p></a></li><li><a href="page_libraries_sunbeam_README.html"><img src="svg/icons/nodejs_small.svg"><p>sunbeam</p></a></li><li><a href="page_libraries_wasteland_README.html"><img src="svg/icons/nodejs_small.svg"><p>wasteland</p></a></li></ul></div><div id="bfx-oss-docs-content"><div id="bfx-oss-docs-header-bar"><h2>API Reference</h2><h2>bfx-hf-models</h2></div><div id="bfx-oss-docs-content-wrapper" class="bfx-oss-docs-content-type-api-docs"><div class="bfx-oss-docs-md-content bfx-oss-docs-code-wrapper"><div id="bfx-oss-docs-api-docs-index"><div id="bfx-oss-docs-api-docs-index__inner"><ul><li><a href="#module_bfx-hf-models">bfx-hf-models</a><ul><li><em>static</em><ul><li><a href="#module_bfx-hf-models.REQUIRED_GENERIC_METHODS">.REQUIRED_GENERIC_METHODS</a></li><li><a href="#module_bfx-hf-models.REQUIRED_COLLECTION_METHODS">.REQUIRED_COLLECTION_METHODS</a></li><li><a href="#module_bfx-hf-models.REQUIRED_MAP_METHODS">.REQUIRED_MAP_METHODS</a></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods">.DBAdapterCollectionMethods</a> : <code>object</code><ul><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..bulkInsert">~bulkInsert</a> ⇒ <code>Array.&lt;object&gt;</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..find">~find</a> ⇒ <code>Array.&lt;object&gt;</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..getAll">~getAll</a> ⇒ <code>Array.&lt;object&gt;</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..getInRange">~getInRange</a> ⇒ <code>Array.&lt;object&gt;</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..insert">~insert</a> ⇒ <code>object</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..rmAll">~rmAll</a> ⇒ <code>number</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..update">~update</a> ⇒ <code>number</code></li></ul></li><li><a href="#module_bfx-hf-models.DBAdapterCriteria">.DBAdapterCriteria</a> : <code>Array</code></li><li><a href="#module_bfx-hf-models.DBAdapterGenericMethods">.DBAdapterGenericMethods</a> : <code>object</code><ul><li><a href="#module_bfx-hf-models.DBAdapterGenericMethods..raw">~raw</a> ⇒ <code>Promise</code></li></ul></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods">.DBAdapterMapMethods</a> : <code>object</code><ul><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..create">~create</a> ⇒ <code>object</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..find">~find</a> ⇒ <code>Array.&lt;object&gt;</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..getAll">~getAll</a> ⇒ <code>object</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..get">~get</a> ⇒ <code>object</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..rm">~rm</a> : <code>function</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..set">~set</a> ⇒ <code>object</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..update">~update</a> ⇒ <code>number</code></li></ul></li><li><a href="#module_bfx-hf-models.DBAdapter">.DBAdapter</a> : <code>object</code></li><li><a href="#module_bfx-hf-models.Model">.Model</a> : <code>object</code></li></ul></li><li><em>inner</em><ul><li><a href="#module_bfx-hf-models.HFDB">~HFDB</a><ul><li><a href="#new_module_bfx-hf-models.HFDB_new">new HFDB(args)</a></li><li><a href="#module_bfx-hf-models.HFDB+close">.close()</a></li></ul></li></ul></li></ul></li></ul></div></div><p><a id="module_bfx-hf-models"></a></p><h2 id="bfx-hf-models"><a class="header-anchor" href="#bfx-hf-models">§</a> bfx-hf-models</h2><p>This module implements a backend-agnostic database system for the Bitfinex Honey Framework. It is used by all HF repos for data storage, i.e:</p><ul><li><a href="module:bfx-hf-data-server">bfx-hf-data-server</a></li><li><a href="module:bfx-hf-algo-server">bfx-hf-algo-server</a></li><li><a href="module:bfx-hf-server">bfx-hf-server</a></li></ul><p>Both the DB backend and exchange-specific schema methods can be configured upon initialization. There are currently two official exchange adapters:</p><ul><li><a href="module:bfx-hf-ext-plugin-bitfinex">bfx-hf-ext-plugin-bitfinex</a> - implements Bitfinex-specific model methods</li><li><a href="module:bfx-hf-ext-plugin-dummy">bfx-hf-ext-plugin-dummy</a> - provides the base set of DB methods</li></ul><p>Besides these, two DB backends are available:</p><ul><li><a href="module:bfx-hf-models-adapter-lowdb">bfx-hf-models-adapter-lowdb</a></li><li><a href="module:bfx-hf-models-adapter-sql">bfx-hf-models-adapter-sql</a> - uses knex internally, allowing flexibility in DB selection</li></ul><p>For the required database adapter structure, see <a href="module:bfx-hf-models-adapter-template">bfx-hf-models-adapter-template</a> or directly <a href="#module_bfx-hf-models.DBAdapter">DBAdapter</a></p><h3 id="features"><a class="header-anchor" href="#features">§</a> Features</h3><ul><li>DB-agnostic; currently two official backends are supported: <code>lowdb</code> and <code>knex</code> for SQL databases.</li><li>Exchange-agnostic; exchange-specific sync logic is provided via a plugin system</li></ul><h4 id="available-models"><a class="header-anchor" href="#available-models">§</a> Available Models</h4><ul><li><a href="module:bfx-hf-models/AlgoOrder">AlgoOrder</a> Algorithmic Order for usage with <a href="module:bfx-hf-algo">bfx-hf-algo</a></li><li><a href="module:bfx-hf-models/Backtest">Backtest</a> Backtest results for <a href="module:bfx-hf-strategy">bfx-hf-strategy</a> and <a href="module:bfx-hf-data-server">bfx-hf-data-server</a></li><li><a href="module:bfx-hf-models/Candle">Candle</a> to be used with backtests</li><li><a href="module:bfx-hf-models/Trade">Trade</a> to be used with backtests</li><li><a href="module:bfx-hf-models/Credential">Credential</a> for encrypted user secrets used with <a href="module:bfx-hf-server">bfx-hf-server</a> (i.e. API keys)</li><li><a href="module:bfx-hf-models/Market">Market</a> providing available exchange market data for <a href="module:bfx-hf-server">bfx-hf-server</a></li><li><a href="module:bfx-hf-models/Strategy">Strategy</a> to save trading strategies created with <a href="module:bfx-hf-strategy">bfx-hf-strategy</a></li><li><a href="module:bfx-hf-models/UserSettings">User Settings</a> to store settings for the <a href="module:bfx-hf-ui">bfx-hf-ui</a> application.</li></ul><h3 id="installation"><a class="header-anchor" href="#installation">§</a> Installation</h3><pre><code class="hljs language-bash">npm i --save bfx-hf-models
</code></pre><h3 id="quickstart"><a class="header-anchor" href="#quickstart">§</a> Quickstart</h3><pre><code class="hljs language-js"><span class="hljs-keyword">const</span> HFDB = <span class="hljs-built_in">require</span>(<span class="hljs-string">'bfx-hf-models'</span>)
<span class="hljs-keyword">const</span> HFDBLowDBAdapter = <span class="hljs-built_in">require</span>(<span class="hljs-string">'bfx-hf-models-adapter-lowdb'</span>)
<span class="hljs-keyword">const</span> { <span class="hljs-attr">schema</span>: DummySchema } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'bfx-hf-ext-plugin-dummy'</span>)

<span class="hljs-keyword">const</span> db = <span class="hljs-keyword">new</span> HFDB({
  <span class="hljs-attr">schema</span>: DummySchema,
  <span class="hljs-attr">adapter</span>: HFDBLowDBAdapter({
    <span class="hljs-attr">dbPath</span>: <span class="hljs-string">'./db.json'</span>,
  })
})

<span class="hljs-comment">// db is now ready to be used; see examples below</span>
</code></pre><p><strong>License</strong>: Apache-2.0<br><a id="module_bfx-hf-models.REQUIRED_GENERIC_METHODS"></a></p><h3 id="bfx-hf-models.required_generic_methods"><a class="header-anchor" href="#bfx-hf-models.required_generic_methods">§</a> bfx-hf-models.REQUIRED_GENERIC_METHODS</h3><p>Array of required <strong>Map</strong> and <strong>Collection</strong> model methods</p><p><strong>Kind</strong>: static constant of <a href="#module_bfx-hf-models"><code>bfx-hf-models</code></a><br><strong>Read only</strong>: true<br><a id="module_bfx-hf-models.REQUIRED_COLLECTION_METHODS"></a></p><h3 id="bfx-hf-models.required_collection_methods"><a class="header-anchor" href="#bfx-hf-models.required_collection_methods">§</a> bfx-hf-models.REQUIRED_COLLECTION_METHODS</h3><p>Array of required <strong>Collection</strong> model methods</p><p><strong>Kind</strong>: static constant of <a href="#module_bfx-hf-models"><code>bfx-hf-models</code></a><br><strong>Read only</strong>: true<br><a id="module_bfx-hf-models.REQUIRED_MAP_METHODS"></a></p><h3 id="bfx-hf-models.required_map_methods"><a class="header-anchor" href="#bfx-hf-models.required_map_methods">§</a> bfx-hf-models.REQUIRED_MAP_METHODS</h3><p>Array of required <strong>Map</strong> model methods</p><p><strong>Kind</strong>: static constant of <a href="#module_bfx-hf-models"><code>bfx-hf-models</code></a><br><strong>Read only</strong>: true<br><a id="module_bfx-hf-models.DBAdapterCollectionMethods"></a></p><h3 id="bfx-hf-models.dbadaptercollectionmethods-%3A-object"><a class="header-anchor" href="#bfx-hf-models.dbadaptercollectionmethods-%3A-object">§</a> bfx-hf-models.DBAdapterCollectionMethods : <code>object</code></h3><p>A set of functions providing functionality for operating on <strong>Collection</strong> models (records identified by index in an array). Additional methods may be provided and will be made available on any <strong>Collection</strong> models, but those listed here are required for a valid <a href="#module_bfx-hf-models">bfx-hf-models</a> database adapter.</p><p><strong>Kind</strong>: static typedef of <a href="#module_bfx-hf-models"><code>bfx-hf-models</code></a><br><strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>find</td><td><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..find"><code>find</code></a></td><td>record query function, returning an array of matches</td></tr><tr><td>rmAll</td><td><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..rmAll"><code>rmAll</code></a></td><td>mass record delete function</td></tr><tr><td>getAll</td><td><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..getAll"><code>getAll</code></a></td><td>mass record query function; same as <code>find</code> but with no criteria</td></tr><tr><td>update</td><td><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..update"><code>update</code></a></td><td>record update function accepting an array of criteria; may update multiple records at once</td></tr><tr><td>insert</td><td><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..insert"><code>insert</code></a></td><td>record creation method</td></tr><tr><td>getInRange</td><td><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..getInRange"><code>getInRange</code></a></td><td>high-level method to query records by criteria and a range of possible key values, with optional sorting of results.</td></tr><tr><td>bulkInsert</td><td><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..bulkInsert"><code>bulkInsert</code></a></td><td>similar to <a href="#module_bfx-hf-models.DBAdapterCollectionMethods..insert">insert</a>, but meant for multiple records and intended to run as one database transaction (should be more performant than individual <code>insert</code> calls, but implementation is up to the adapter)</td></tr></tbody></table><ul><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods">.DBAdapterCollectionMethods</a> : <code>object</code><ul><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..bulkInsert">~bulkInsert</a> ⇒ <code>Array.&lt;object&gt;</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..find">~find</a> ⇒ <code>Array.&lt;object&gt;</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..getAll">~getAll</a> ⇒ <code>Array.&lt;object&gt;</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..getInRange">~getInRange</a> ⇒ <code>Array.&lt;object&gt;</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..insert">~insert</a> ⇒ <code>object</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..rmAll">~rmAll</a> ⇒ <code>number</code></li><li><a href="#module_bfx-hf-models.DBAdapterCollectionMethods..update">~update</a> ⇒ <code>number</code></li></ul></li></ul><p><a id="module_bfx-hf-models.DBAdapterCollectionMethods..bulkInsert"></a></p><h4 id="dbadaptercollectionmethods~bulkinsert-%E2%87%92-array.%3Cobject%3E"><a class="header-anchor" href="#dbadaptercollectionmethods~bulkinsert-%E2%87%92-array.%3Cobject%3E">§</a> DBAdapterCollectionMethods~bulkInsert ⇒ <code>Array.&lt;object&gt;</code></h4><p>Function that inserts an array of records at once into the database. Meant for large inserts, should be optimized within the respective adapter.</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterCollectionMethods"><code>DBAdapterCollectionMethods</code></a><br><strong>Returns</strong>: <code>Array.&lt;object&gt;</code> - insertedRecords</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>records</td><td><code>Array.&lt;object&gt;</code></td><td>records to insert</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterCollectionMethods..find"></a></p><h4 id="dbadaptercollectionmethods~find-%E2%87%92-array.%3Cobject%3E"><a class="header-anchor" href="#dbadaptercollectionmethods~find-%E2%87%92-array.%3Cobject%3E">§</a> DBAdapterCollectionMethods~find ⇒ <code>Array.&lt;object&gt;</code></h4><p>Function returning all records matching the provided criteria.</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterCollectionMethods"><code>DBAdapterCollectionMethods</code></a><br><strong>Returns</strong>: <code>Array.&lt;object&gt;</code> - records - matching records</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>criteria</td><td><a href="#module_bfx-hf-models.DBAdapterCriteria"><code>Array.&lt;DBAdapterCriteria&gt;</code></a></td><td>array of criteria which must be met for a record to be included in the results</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterCollectionMethods..getAll"></a></p><h4 id="dbadaptercollectionmethods~getall-%E2%87%92-array.%3Cobject%3E"><a class="header-anchor" href="#dbadaptercollectionmethods~getall-%E2%87%92-array.%3Cobject%3E">§</a> DBAdapterCollectionMethods~getAll ⇒ <code>Array.&lt;object&gt;</code></h4><p>Function that returns all records in the collection.</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterCollectionMethods"><code>DBAdapterCollectionMethods</code></a><br><strong>Returns</strong>: <code>Array.&lt;object&gt;</code> - records - all records in the collection</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterCollectionMethods..getInRange"></a></p><h4 id="dbadaptercollectionmethods~getinrange-%E2%87%92-array.%3Cobject%3E"><a class="header-anchor" href="#dbadaptercollectionmethods~getinrange-%E2%87%92-array.%3Cobject%3E">§</a> DBAdapterCollectionMethods~getInRange ⇒ <code>Array.&lt;object&gt;</code></h4><p>Function that returns all records matching the provided criteria, and having a key with a value in the provided start/end range (numeric).</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterCollectionMethods"><code>DBAdapterCollectionMethods</code></a><br><strong>Returns</strong>: <code>Array.&lt;object&gt;</code> - records - matching records</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>criteria</td><td><a href="#module_bfx-hf-models.DBAdapterCriteria"><code>Array.&lt;DBAdapterCriteria&gt;</code></a></td><td>array of criteria to be met for a record to be matched, prior to range check</td></tr><tr><td>range</td><td><code>object</code></td><td>range definition</td></tr><tr><td>range.key</td><td><code>string</code></td><td>key name on records to be checked against start/end limits</td></tr><tr><td>range.start</td><td><code>number</code></td><td>minimum value for <code>range.key</code></td></tr><tr><td>range.end</td><td><code>number</code></td><td>maximum value for <code>range.key</code></td></tr><tr><td>[sort]</td><td><code>object</code></td><td>sort parameters</td></tr><tr><td>[sort.orderBy]</td><td><code>string</code></td><td>key to sort results by</td></tr><tr><td>[sort.orderDirection]</td><td><code>string</code></td><td><code>'desc'</code> for descending results, otherwise ascending.</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterCollectionMethods..insert"></a></p><h4 id="dbadaptercollectionmethods~insert-%E2%87%92-object"><a class="header-anchor" href="#dbadaptercollectionmethods~insert-%E2%87%92-object">§</a> DBAdapterCollectionMethods~insert ⇒ <code>object</code></h4><p>Function that adds a new record to the collection.</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterCollectionMethods"><code>DBAdapterCollectionMethods</code></a><br><strong>Returns</strong>: <code>object</code> - record - inserted record data</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>record</td><td><code>object</code></td><td>record to be inserted</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterCollectionMethods..rmAll"></a></p><h4 id="dbadaptercollectionmethods~rmall-%E2%87%92-number"><a class="header-anchor" href="#dbadaptercollectionmethods~rmall-%E2%87%92-number">§</a> DBAdapterCollectionMethods~rmAll ⇒ <code>number</code></h4><p>Function that removes all records from the collection.</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterCollectionMethods"><code>DBAdapterCollectionMethods</code></a><br><strong>Returns</strong>: <code>number</code> - nRemoved - number of removed records</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterCollectionMethods..update"></a></p><h4 id="dbadaptercollectionmethods~update-%E2%87%92-number"><a class="header-anchor" href="#dbadaptercollectionmethods~update-%E2%87%92-number">§</a> DBAdapterCollectionMethods~update ⇒ <code>number</code></h4><p>Function that updates all records matching the criteria with the provided data.</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterCollectionMethods"><code>DBAdapterCollectionMethods</code></a><br><strong>Returns</strong>: <code>number</code> - nModified - number of modified records</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>criteria</td><td><a href="#module_bfx-hf-models.DBAdapterCriteria"><code>Array.&lt;DBAdapterCriteria&gt;</code></a></td><td>array of criteria to be met for a record to be updated</td></tr><tr><td>data</td><td><code>object</code></td><td>data to saved on matching records; partial update</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterCriteria"></a></p><h3 id="bfx-hf-models.dbadaptercriteria-%3A-array"><a class="header-anchor" href="#bfx-hf-models.dbadaptercriteria-%3A-array">§</a> bfx-hf-models.DBAdapterCriteria : <code>Array</code></h3><p>An array containing 3 values; a field name, condition, and target value. For example:</p><p><code>['fieldA', '&lt;', 1000]</code> - states that fieldA must be less than 1000</p><p>Used to run queries against the DB.</p><p><strong>Kind</strong>: static typedef of <a href="#module_bfx-hf-models"><code>bfx-hf-models</code></a><br><strong>See</strong>: module:bfx-hf-models.DBAdapterMapMethods~find<br><strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>0</td><td><code>string</code></td><td>field name on record, value used as <code>lvalue</code></td></tr><tr><td>1</td><td><code>string</code></td><td>condition, can be ‘=’, ‘!=’, ‘&gt;’, ‘&gt;=’, ‘&lt;’, or ‘&lt;=’</td></tr><tr><td>2</td><td><code>string</code> | <code>number</code></td><td><code>rvalue</code></td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterGenericMethods"></a></p><h3 id="bfx-hf-models.dbadaptergenericmethods-%3A-object"><a class="header-anchor" href="#bfx-hf-models.dbadaptergenericmethods-%3A-object">§</a> bfx-hf-models.DBAdapterGenericMethods : <code>object</code></h3><p>A set of functions shared by both <strong>Map</strong> and <strong>Collection</strong> models. Additional methods may be provided and will be made available on any models, but those listed here are required for a valid <a href="#module_bfx-hf-models">bfx-hf-models</a> database adapter.</p><p><strong>Kind</strong>: static typedef of <a href="#module_bfx-hf-models"><code>bfx-hf-models</code></a><br><strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>raw</td><td><a href="#module_bfx-hf-models.DBAdapterGenericMethods..raw"><code>raw</code></a></td><td>raw database query method</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterGenericMethods..raw"></a></p><h4 id="dbadaptergenericmethods~raw-%E2%87%92-promise"><a class="header-anchor" href="#dbadaptergenericmethods~raw-%E2%87%92-promise">§</a> DBAdapterGenericMethods~raw ⇒ <code>Promise</code></h4><p>Function providing access to the underlying database object for custom queries.</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterGenericMethods"><code>DBAdapterGenericMethods</code></a><br><strong>Returns</strong>: <code>Promise</code> - p - as returned by the callback <code>cb</code></p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>cb</td><td><code>function</code></td><td>called with <code>(db, model)</code>, must return a promise</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterMapMethods"></a></p><h3 id="bfx-hf-models.dbadaptermapmethods-%3A-object"><a class="header-anchor" href="#bfx-hf-models.dbadaptermapmethods-%3A-object">§</a> bfx-hf-models.DBAdapterMapMethods : <code>object</code></h3><p>A set of functions providing functionality for operating on <strong>Map</strong> models (records identified by a unique key). Additional methods may be provided and will be made available on any <strong>Map</strong> models, but those listed here are required for a valid <a href="#module_bfx-hf-models">bfx-hf-models</a> database adapter.</p><p><strong>Kind</strong>: static typedef of <a href="#module_bfx-hf-models"><code>bfx-hf-models</code></a><br><strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>create</td><td><a href="#module_bfx-hf-models.DBAdapterMapMethods..create"><code>create</code></a></td><td>record creation method (throws error if the record already exists)</td></tr><tr><td>update</td><td><a href="#module_bfx-hf-models.DBAdapterMapMethods..update"><code>update</code></a></td><td>record update (full) method (throws error if the record does not exist)</td></tr><tr><td>find</td><td><a href="#module_bfx-hf-models.DBAdapterMapMethods..find"><code>find</code></a></td><td>record query method, accepting an array of one or multiple criteria to be matched</td></tr><tr><td>getAll</td><td><a href="#module_bfx-hf-models.DBAdapterMapMethods..getAll"><code>getAll</code></a></td><td>full collection query method; must return a map of all records key’ed by <code>mapKey</code> as stored in the DB.</td></tr><tr><td>get</td><td><a href="#module_bfx-hf-models.DBAdapterMapMethods..get"><code>get</code></a></td><td>single record query method by ID or record-like object containing ID.</td></tr><tr><td>set</td><td><a href="#module_bfx-hf-models.DBAdapterMapMethods..set"><code>set</code></a></td><td>single record create/update method</td></tr><tr><td>rm</td><td><a href="#module_bfx-hf-models.DBAdapterMapMethods..rm"><code>rm</code></a></td><td>single record removal method; throws an error if the record does not exist</td></tr></tbody></table><ul><li><a href="#module_bfx-hf-models.DBAdapterMapMethods">.DBAdapterMapMethods</a> : <code>object</code><ul><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..create">~create</a> ⇒ <code>object</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..find">~find</a> ⇒ <code>Array.&lt;object&gt;</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..getAll">~getAll</a> ⇒ <code>object</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..get">~get</a> ⇒ <code>object</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..rm">~rm</a> : <code>function</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..set">~set</a> ⇒ <code>object</code></li><li><a href="#module_bfx-hf-models.DBAdapterMapMethods..update">~update</a> ⇒ <code>number</code></li></ul></li></ul><p><a id="module_bfx-hf-models.DBAdapterMapMethods..create"></a></p><h4 id="dbadaptermapmethods~create-%E2%87%92-object"><a class="header-anchor" href="#dbadaptermapmethods~create-%E2%87%92-object">§</a> DBAdapterMapMethods~create ⇒ <code>object</code></h4><p>Function that creates a <strong>Map</strong> model record in the database. Like all database methods, it is provided the initialized <strong>model</strong> object, which as per the spec provides a <code>mapKey</code> function argument which is defined on the model itself, and used to generate the unique key.</p><p>To create <strong>or</strong> update a record if it already exists, see <a href="#module_bfx-hf-models.DBAdapterMapMethods..set">set</a></p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterMapMethods"><code>DBAdapterMapMethods</code></a><br><strong>Returns</strong>: <code>object</code> - record - created record<br><strong>Throws</strong>:</p><ul><li><code>Error</code> if a record already exists with the same key</li></ul><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>data</td><td><code>object</code></td><td>data to be saved as a new record</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterMapMethods..find"></a></p><h4 id="dbadaptermapmethods~find-%E2%87%92-array.%3Cobject%3E"><a class="header-anchor" href="#dbadaptermapmethods~find-%E2%87%92-array.%3Cobject%3E">§</a> DBAdapterMapMethods~find ⇒ <code>Array.&lt;object&gt;</code></h4><p>Function that returns all records matching the provided criteria.</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterMapMethods"><code>DBAdapterMapMethods</code></a><br><strong>Returns</strong>: <code>Array.&lt;object&gt;</code> - records - array of records matching the provided criteria</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>criteria</td><td><a href="#module_bfx-hf-models.DBAdapterCriteria"><code>Array.&lt;DBAdapterCriteria&gt;</code></a></td><td>array of conditions to apply to records in the collection; the first record meeting all conditions is returned as the “found” record.</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterMapMethods..getAll"></a></p><h4 id="dbadaptermapmethods~getall-%E2%87%92-object"><a class="header-anchor" href="#dbadaptermapmethods~getall-%E2%87%92-object">§</a> DBAdapterMapMethods~getAll ⇒ <code>object</code></h4><p>Function that returns all records in a <strong>Map</strong> as an object, with records key’ed by their map key.</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterMapMethods"><code>DBAdapterMapMethods</code></a><br><strong>Returns</strong>: <code>object</code> - records - map of all records, key’ed by <code>mapKey</code></p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterMapMethods..get"></a></p><h4 id="dbadaptermapmethods~get-%E2%87%92-object"><a class="header-anchor" href="#dbadaptermapmethods~get-%E2%87%92-object">§</a> DBAdapterMapMethods~get ⇒ <code>object</code></h4><p>Function that returns a single record by ID. Also accepts a record-like object containing at least the ID (i.e. <code>{ id: 42 }</code>)</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterMapMethods"><code>DBAdapterMapMethods</code></a><br><strong>Returns</strong>: <code>object</code> - record - matching record</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>docOrID</td><td><code>object</code> | <code>string</code> | <code>number</code></td><td>record to fetch or its ID</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterMapMethods..rm"></a></p><h4 id="dbadaptermapmethods~rm-%3A-function"><a class="header-anchor" href="#dbadaptermapmethods~rm-%3A-function">§</a> DBAdapterMapMethods~rm : <code>function</code></h4><p>Function that deletes a single record by ID. Also accepts a record-like object containing at least the ID (i.e. <code>{ id: 42 }</code>).</p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterMapMethods"><code>DBAdapterMapMethods</code></a><br><strong>Throws</strong>:</p><ul><li><code>Error</code> if the record does not exist</li></ul><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>docOrID</td><td><code>object</code> | <code>string</code> | <code>number</code></td><td>record to remove or its ID</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterMapMethods..set"></a></p><h4 id="dbadaptermapmethods~set-%E2%87%92-object"><a class="header-anchor" href="#dbadaptermapmethods~set-%E2%87%92-object">§</a> DBAdapterMapMethods~set ⇒ <code>object</code></h4><p>Function that creates or updates a single record by ID. Also accepts a record-like object containing at least the ID (i.e. <code>{ id: 42 }</code>).</p><p>To ensure existing records are not modified, use <a href="#module_bfx-hf-models.DBAdapterMapMethods..create">create</a></p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterMapMethods"><code>DBAdapterMapMethods</code></a><br><strong>Returns</strong>: <code>object</code> - record - final record value as stored in the DB</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>value</td><td><code>object</code></td><td>record value, containing relevant data for key generation. Any existing record with the same key will be overwritten.</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapterMapMethods..update"></a></p><h4 id="dbadaptermapmethods~update-%E2%87%92-number"><a class="header-anchor" href="#dbadaptermapmethods~update-%E2%87%92-number">§</a> DBAdapterMapMethods~update ⇒ <code>number</code></h4><p>Function that updates an existing <strong>Map</strong> model record in the database. Must accept either the unique ID (key value) of the model to be updated, or the model itself (containing the ID).</p><p>Must perform a full update. To create a record if it does not exist (or update), use <a href="#module_bfx-hf-models.DBAdapterMapMethods..set">set</a></p><p><strong>Kind</strong>: inner typedef of <a href="#module_bfx-hf-models.DBAdapterMapMethods"><code>DBAdapterMapMethods</code></a><br><strong>Returns</strong>: <code>number</code> - nUpdatedRows - number of updated rows<br><strong>Throws</strong>:</p><ul><li><code>Error</code> fails if the record does not exist.</li></ul><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>db</td><td><code>object</code></td><td>database object as provided by adapter</td></tr><tr><td>model</td><td><a href="#module_bfx-hf-models.Model"><code>Model</code></a></td><td>initialized model instance</td></tr><tr><td>docOrID</td><td><code>object</code> | <code>string</code> | <code>number</code></td><td>record to update or its ID</td></tr><tr><td>value</td><td><code>object</code></td><td>new data for the record</td></tr></tbody></table><p><a id="module_bfx-hf-models.DBAdapter"></a></p><h3 id="bfx-hf-models.dbadapter-%3A-object"><a class="header-anchor" href="#bfx-hf-models.dbadapter-%3A-object">§</a> bfx-hf-models.DBAdapter : <code>object</code></h3><p>Database adapter structure for usage with <a href="#module_bfx-hf-models">bfx-hf-models</a>. For an example module refer to <a href="module:bfx-hf-models-adapter-template">bfx-hf-models-adapter-template</a></p><p>For reference implementations (in-memory &amp; SQL) see:</p><ul><li><a href="module:bfx-hf-models-adapter-lowdb">bfx-hf-models-adapter-lowdb</a></li><li><a href="module:bfx-hf-models-adapter-sql">bfx-hf-models-adapter-sql</a></li></ul><p>It must provide methods for performing all database operations required for a <a href="#module_bfx-hf-models">bfx-hf-models</a> backend. Additional methods may be provided and used, but the base set defined in this <strong>type</strong> are required.</p><p>For reference, a <strong>Map</strong> model is a set of records identified by a unique key, and a <strong>Collection</strong> model is a set of records stored as an array (key’ed by index).</p><p><strong>Kind</strong>: static typedef of <a href="#module_bfx-hf-models"><code>bfx-hf-models</code></a><br><strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td><code>string</code></td><td>name of the adapter, i.e. ‘Redis’ or ‘PSQL’, etc</td></tr><tr><td>db</td><td><code>object</code></td><td>database object provided to all methods (i.e. DB client, or in-memory DB reference, etc)</td></tr><tr><td>[dbInit]</td><td><code>function</code></td><td>if provided, this function is called to and expected to provide the <code>db</code> object, overriding any provided on this adapter. It is called with each model instance, post-initialization, and then passed to the model for all DB-related methods.</td></tr><tr><td>[close]</td><td><code>function</code></td><td>if provided, this function is called when the adapter is closed. Use this to clean up the database connection and flush any unsaved changes.</td></tr><tr><td>mapMethods</td><td><a href="#module_bfx-hf-models.DBAdapterMapMethods"><code>DBAdapterMapMethods</code></a></td><td>object of methods for operating on <strong>Map</strong> models (collections of records identified by unique key)</td></tr><tr><td>collectionMethods</td><td><a href="#module_bfx-hf-models.DBAdapterCollectionMethods"><code>DBAdapterCollectionMethods</code></a></td><td>object of methods for operating on <strong>Collection</strong> models (identified by index)</td></tr><tr><td></td><td><a href="#module_bfx-hf-models.DBAdapterGenericMethods"><code>DBAdapterGenericMethods</code></a></td><td>object of methods shared by all model types. i.e. raw database query support.</td></tr></tbody></table><p><a id="module_bfx-hf-models.Model"></a></p><h3 id="bfx-hf-models.model-%3A-object"><a class="header-anchor" href="#bfx-hf-models.model-%3A-object">§</a> bfx-hf-models.Model : <code>object</code></h3><p>A <a href="#module_bfx-hf-models">bfx-hf-models</a> model as defined by a path in the database, name, type, schema, and any required data depending on the model type.</p><p><strong>Kind</strong>: static typedef of <a href="#module_bfx-hf-models"><code>bfx-hf-models</code></a><br><strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>path</td><td><code>string</code></td><td>location in database; final path depends on the adapter used, with this property only needing to be unique. May be a table name or key in an in-memory DB.</td></tr><tr><td>name</td><td><code>string</code></td><td>human readable model name</td></tr><tr><td>type</td><td><code>string</code></td><td>one of <a href="module:bfx-hf-models.MODEL_TYPES">module:bfx-hf-models.MODEL_TYPES</a></td></tr><tr><td>schema</td><td><code>object</code></td><td>map of record key names to Javascript primitive types, i.e. <code>{ gid: String }</code></td></tr><tr><td>[mapKey]</td><td><code>string</code> | <code>function</code></td><td>required for map models, either a string with the key name or a function taking a model instance as the only argument and returning the model’s unique key.</td></tr><tr><td>[index]</td><td><code>string</code></td><td>name of key used as index for collections instead of position in the collection. Meant to be used in conjunction with <code>indexMatches</code> for updating documents in upserts. Only for <strong>collection</strong> models.</td></tr><tr><td>[indexMatches]</td><td><code>Array.&lt;string&gt;</code></td><td>array of key names which must match for two records to be considered the same in a collection. Used to update documents in upserts. Only for <strong>collection</strong> models.</td></tr></tbody></table><p><a id="module_bfx-hf-models.HFDB"></a></p><h3 id="bfx-hf-models~hfdb"><a class="header-anchor" href="#bfx-hf-models~hfdb">§</a> bfx-hf-models~HFDB</h3><p>Database class, takes a storage adapter and database schema as constructor options, then handles model persistence.</p><p><strong>Kind</strong>: inner class of <a href="#module_bfx-hf-models"><code>bfx-hf-models</code></a></p><ul><li><a href="#module_bfx-hf-models.HFDB">~HFDB</a><ul><li><a href="#new_module_bfx-hf-models.HFDB_new">new HFDB(args)</a></li><li><a href="#module_bfx-hf-models.HFDB+close">.close()</a></li></ul></li></ul><p><a id="new_module_bfx-hf-models.HFDB_new"></a></p><h4 id="new-hfdb(args)"><a class="header-anchor" href="#new-hfdb(args)">§</a> new HFDB(args)</h4><p>Create a new database instance. Models will be key’ed by name on the class after initialization.</p><p><strong>Throws</strong>:</p><ul><li><code>Error</code> if given an invalid adapter (missing required method or having an otherwise invalid structure)</li></ul><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>args</td><td><code>object</code></td><td>arguments</td></tr><tr><td>args.adapter</td><td><a href="#module_bfx-hf-models.DBAdapter"><code>DBAdapter</code></a></td><td>database adapter. See <a href="module:bfx-hf-models-adapter-sql">module:bfx-hf-models-adapter-sql</a> for an example, or the type definition itself for a listing of required logic.</td></tr><tr><td>args.schema</td><td><code>object</code></td><td>database schema providing custom models on top of the builtins. See <a href="module:bfx-hf-ext-plugin-bitfinex">module:bfx-hf-ext-plugin-bitfinex</a> for an example.</td></tr></tbody></table><p><strong>Example</strong></p><pre><code class="hljs language-js"><span class="hljs-keyword">const</span> HFDBSQLAdapter = <span class="hljs-built_in">require</span>(<span class="hljs-string">'bfx-hf-models-adapter-sql'</span>)
<span class="hljs-keyword">const</span> { <span class="hljs-attr">schema</span>: HFDBBitfinexSchema } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'bfx-hf-ext-plugin-bitfinex'</span>)
<span class="hljs-keyword">const</span> { PSQL_CONNECTION } = process.env

<span class="hljs-keyword">const</span> db = <span class="hljs-keyword">new</span> HFDB({
  <span class="hljs-attr">schema</span>: HFDBBitfinexSchema,
  <span class="hljs-attr">adapter</span>: HFDBSQLAdapter({
    <span class="hljs-attr">connection</span>: PSQL_CONNECTION,
    <span class="hljs-attr">clientType</span>: <span class="hljs-string">'pg'</span>
  })
})

<span class="hljs-keyword">const</span> { Trade } = db
<span class="hljs-keyword">const</span> trades = <span class="hljs-keyword">await</span> Trade.getAll()

trades.forEach(<span class="hljs-function"><span class="hljs-params">t</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(t, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>)))
</code></pre><p><a id="module_bfx-hf-models.HFDB+close"></a></p><h4 id="hfdb.close()"><a class="header-anchor" href="#hfdb.close()">§</a> hfdB.close()</h4><p>Closes any DB connection; calls through to <code>close()</code> on the adapter, hence behavior is dependent on the adapter used.</p><p><strong>Kind</strong>: instance method of <a href="#module_bfx-hf-models.HFDB"><code>HFDB</code></a></p></div></div><!--
      <div id="bfx-oss-docs-footer-bar">
        <div id="bfx-oss-docs-footer-bar__container">
          <p>Copyright © 2013-2020 iFinex Inc. All rights reserved.</p>
        </div>
      </div>
      --></div><script type="text/javascript" src="js/vendor/debug.min.js"></script><script type="text/javascript" src="js/vendor/lodash.min.js"></script><script type="text/javascript" src="js/vendor/zepto.min.js"></script><script type="text/javascript" src="js/vendor/perfect-scrollbar.min.js"></script><script type="text/javascript" src="js/main.js"></script></body></html>