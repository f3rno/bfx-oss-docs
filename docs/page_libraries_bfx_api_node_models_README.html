<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width,initial-scale=1"><meta charset="utf-8"><link rel="stylesheet" type="text/css" href="css/normalize.css"><link rel="stylesheet" type="text/css" href="css/perfect-scrollbar.css"><link rel="stylesheet" type="text/css" href="css/highlightjs/night-owl.css"><link rel="stylesheet" type="text/css" href="index.css"><title>README | bfx-api-node-models</title></head><body><div id="bfx-oss-docs-side-bar"><div id="bfx-oss-docs-side-bar__header"><img src="img/bfx-logo-bg-white.png" alt="Bitfinex" height="63"></div><ul><li><a href="index.html"><p>Home</p></a></li><li><a href="page_md_render_test.html"><p>Markdown Render Test</p></a></li><li><a href="page_libraries_bitfinex_api_py_README.html"><img src="svg/icons/python.svg"><p>bitfinex-api-py</p></a></li><li><a href="page_libraries_bfx_hf_strategy_py_README.html"><img src="svg/icons/python.svg"><p>bfx-hf-strategy-py</p></a></li><li><a href="page_libraries_bfx_hf_indicators_py_README.html"><img src="svg/icons/python.svg"><p>bfx-hf-indicators-py</p></a></li><li><a href="page_libraries_bitfinex_api_go_README.html"><img src="svg/icons/go.svg"><p>bitfinex-api-go</p></a></li><li><a href="page_libraries_bfxfixgw_README.html"><img src="svg/icons/go.svg"><p>bfxfixgw</p></a></li><li><a href="page_libraries_bitfinex_api_rb_README.html"><img src="svg/icons/ruby.svg"><p>bitfinex-api-rb</p></a></li><li><a href="page_libraries_bitfinex_api_node_README.html"><img src="svg/icons/nodejs_small.svg"><p>bitfinex-api-node</p></a></li><li><a href="page_libraries_bfx_api_mock_srv_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-mock-srv</p></a></li><li><a href="page_libraries_bfx_api_node_core_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-core</p></a></li><li class="active"><a href="page_libraries_bfx_api_node_models_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-models</p></a><ul><li class="active"><a href="page_libraries_bfx_api_node_models_README.html"><p>- README</p></a></li><li><a href="page_libraries_bfx_api_node_models_reference.html"><p>- API Reference</p></a></li></ul></li><li><a href="page_libraries_bfx_api_node_plugin_example_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-example</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_managed_candles_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-managed-candles</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_managed_ob_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-managed-ob</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_ob_checksum_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-ob-checksum</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_seq_audit_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-seq-audit</p></a></li><li><a href="page_libraries_bfx_api_node_plugin_wd_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-wd</p></a></li><li><a href="page_libraries_bfx_api_node_rest_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-rest</p></a></li><li><a href="page_libraries_bfx_api_node_util_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-util</p></a></li><li><a href="page_libraries_bfx_api_node_ws1_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-ws1</p></a></li><li><a href="page_libraries_bfx_hf_backtest_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-backtest</p></a></li><li><a href="page_libraries_bfx_hf_chart_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-chart</p></a></li><li><a href="page_libraries_bfx_hf_data_server_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-data-server</p></a></li><li><a href="page_libraries_bfx_hf_ext_plugin_bitfinex_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-ext-plugin-bitfinex</p></a></li><li><a href="page_libraries_bfx_hf_ext_plugin_dummy_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-ext-plugin-dummy</p></a></li><li><a href="page_libraries_bfx_hf_indicators_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-indicators</p></a></li><li><a href="page_libraries_bfx_hf_models_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models</p></a></li><li><a href="page_libraries_bfx_hf_models_adapter_lowdb_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-lowdb</p></a></li><li><a href="page_libraries_bfx_hf_models_adapter_sql_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-sql</p></a></li><li><a href="page_libraries_bfx_hf_models_adapter_template_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-template</p></a></li><li><a href="page_libraries_bfx_hf_algo_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-algo</p></a></li><li><a href="page_libraries_bfx_hf_server_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-server</p></a></li><li><a href="page_libraries_bfx_hf_strategy_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-strategy</p></a></li><li><a href="page_libraries_bfx_hf_strategy_exec_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-strategy-exec</p></a></li><li><a href="page_libraries_bfx_hf_ui_config_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-ui-config</p></a></li><li><a href="page_libraries_bfx_hf_util_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-util</p></a></li><li><a href="page_libraries_bfx_ws2_api_audit_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-ws2-api-audit</p></a></li><li><a href="page_libraries_cbq_js_README.html"><img src="svg/icons/nodejs_small.svg"><p>cbq-js</p></a></li><li><a href="page_libraries_caron_README.html"><img src="svg/icons/nodejs_small.svg"><p>caron</p></a></li><li><a href="page_libraries_eos_name_verify_README.html"><img src="svg/icons/nodejs_small.svg"><p>eos-name-verify</p></a></li><li><a href="page_libraries_grenache_browser_http_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-browser-http</p></a></li><li><a href="page_libraries_grenache_grape_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-grape</p></a></li><li><a href="page_libraries_grenache_nodejs_base_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-base</p></a></li><li><a href="page_libraries_grenache_nodejs_http_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-http</p></a></li><li><a href="page_libraries_grenache_nodejs_link_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-link</p></a></li><li><a href="page_libraries_grenache_nodejs_utp_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-utp</p></a></li><li><a href="page_libraries_grenache_nodejs_ws_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-ws</p></a></li><li><a href="page_libraries_grenache_nodejs_ws_tls_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-ws-tls</p></a></li><li><a href="page_libraries_lib_js_util_currencies_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-currencies</p></a></li><li><a href="page_libraries_lib_js_util_math_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-math</p></a></li><li><a href="page_libraries_lib_js_util_number_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-number</p></a></li><li><a href="page_libraries_lib_js_util_symbol_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-symbol</p></a></li><li><a href="page_libraries_smidgen_README.html"><img src="svg/icons/nodejs_small.svg"><p>smidgen</p></a></li><li><a href="page_libraries_sunbeam_README.html"><img src="svg/icons/nodejs_small.svg"><p>sunbeam</p></a></li><li><a href="page_libraries_wasteland_README.html"><img src="svg/icons/nodejs_small.svg"><p>wasteland</p></a></li></ul></div><div id="bfx-oss-docs-content"><div id="bfx-oss-docs-header-bar"><h2>README</h2><h2>bfx-api-node-models</h2></div><div id="bfx-oss-docs-content-wrapper" class="bfx-oss-docs-content-type-api-docs"><div class="bfx-oss-docs-md-content bfx-oss-docs-code-wrapper"><div id="bfx-oss-docs-api-docs-index"><div id="bfx-oss-docs-api-docs-index__inner"><nav class="bfx-oss-docs-md-toc"><ol><li><a href="#bitfinex-data-models-for-node.js">Bitfinex Data Models for Node.JS</a><ol><li><a href="#features">Features</a></li><li><a href="#installation">Installation</a></li><li><a href="#quickstart">Quickstart</a></li><li><a href="#docs">Docs</a></li><li><a href="#examples">Examples</a></li><li><a href="#contributing">Contributing</a></li></ol></li></ol></nav></div></div><h1 id="bitfinex-data-models-for-node.js"><a class="header-anchor" href="#bitfinex-data-models-for-node.js">ยง</a> Bitfinex Data Models for Node.JS</h1><p><a href="https://travis-ci.org/bitfinexcom/bfx-api-node-models"><img src="https://travis-ci.org/bitfinexcom/bfx-api-node-models.svg?branch=master" alt="Build Status"></a></p><p>This repo contains model classes for working with the data structures returned by the Bitfinex REST &amp; WebSocket APIs. The models can all be initialized with an array-format payload as returned by an API call, and can be unserialized back to the array format when needed.</p><p>Some models, such as <code>Order</code> and <code>OrderBook</code> provide higher level methods which operate on the underlying data sets.</p><p>All models provide <code>serialize()</code> and <code>unserialize()</code> methods, which convert to/from array-format payloads respectively. All model constructors can take either array-format payloads, or objects/other model instances. A helper <code>toJS()</code> method is also provided for converting models to plain JS objects (POJOs).</p><h3 id="features"><a class="header-anchor" href="#features">ยง</a> Features</h3><ul><li>Convert between array, object, and class representations of API data</li><li>Class methods for operating on model data where applicable (i.e. <code>OrderBook</code>)</li></ul><p>Classes for the following Bitfinex API data types:</p><ul><li>Alert</li><li>BalanceInfo</li><li>Candle</li><li>Currency</li><li>FundingCredit</li><li>FundingInfo</li><li>FundingLoan</li><li>FundingOffer</li><li>FundingTickerHist</li><li>FundingTicker</li><li>FundingTrade</li><li>LedgerEntry</li><li>Liquidations</li><li>MarginInfo</li><li>Movement</li><li>Notification</li><li>OrderBook</li><li>Order</li><li>Position</li><li>PublicTrade</li><li>StatusMessagesDeriv</li><li>Trade</li><li>TradingTicker</li><li>TradingTickerHist</li><li>UserInfo</li><li>Wallet</li><li>WalletHist</li><li>Currency</li></ul><h3 id="installation"><a class="header-anchor" href="#installation">ยง</a> Installation</h3><pre><code class="hljs language-js">npm i --save bfx-api-node-models
</code></pre><h3 id="quickstart"><a class="header-anchor" href="#quickstart">ยง</a> Quickstart</h3><pre><code class="hljs language-js"><span class="hljs-keyword">const</span> { Order } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'bfx-api-node-models'</span>)

<span class="hljs-keyword">const</span> o = <span class="hljs-keyword">new</span> Order({
  <span class="hljs-attr">cid</span>: <span class="hljs-built_in">Date</span>.now(),
  <span class="hljs-attr">symbol</span>: <span class="hljs-string">'tBTCUSD'</span>,
  <span class="hljs-attr">price</span>: <span class="hljs-number">7000.0</span>,
  <span class="hljs-attr">amount</span>: <span class="hljs-number">-0.02</span>,
  <span class="hljs-attr">type</span>: Order.type.EXCHANGE_LIMIT
})

<span class="hljs-comment">// Generate an API-compatible order creation packet for later submit</span>
<span class="hljs-built_in">console</span>.log(o.toNewOrderPacket())
</code></pre><h3 id="docs"><a class="header-anchor" href="#docs">ยง</a> Docs</h3><p>Refer to the <a href="https://cdn.statically.io/gh/bitfinexcom/bfx-api-node-models/master/docs/index.html">docs/</a> folder for JSDoc-generated API documentation covering each model class.</p><h3 id="examples"><a class="header-anchor" href="#examples">ยง</a> Examples</h3><p>The order model provides helper methods for order submission, updates, and cancellation. These methods are compatible with version 2.0.0 of <code>bitfinex-api-node</code>, and return promises which resolve upon receival of the relevant success/error notifications.</p><p>Orders are matched with their API packets by one/all of <code>id</code>, <code>gid</code>, and <code>cid</code>.</p><p>Example usage:</p><pre><code class="hljs language-js"><span class="hljs-keyword">const</span> { Order } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'bfx-api-node-models'</span>)
<span class="hljs-keyword">const</span> ws = ... <span class="hljs-comment">// setup WSv2 instance for order updates/submission</span>

<span class="hljs-comment">// Build new order</span>
<span class="hljs-keyword">const</span> o = <span class="hljs-keyword">new</span> Order({
  <span class="hljs-attr">cid</span>: <span class="hljs-built_in">Date</span>.now(),
  <span class="hljs-attr">symbol</span>: <span class="hljs-string">'tBTCUSD'</span>,
  <span class="hljs-attr">price</span>: <span class="hljs-number">7000.0</span>,
  <span class="hljs-attr">amount</span>: <span class="hljs-number">-0.02</span>,
  <span class="hljs-attr">type</span>: Order.type.EXCHANGE_LIMIT
}, ws) <span class="hljs-comment">// note WSv2 client passed in here</span>

<span class="hljs-keyword">let</span> closed = <span class="hljs-literal">false</span>

<span class="hljs-comment">// Enable automatic updates</span>
o.registerListeners()

o.on(<span class="hljs-string">'update'</span>, () =&gt; {
  debug(<span class="hljs-string">'order updated: %j'</span>, o.serialize())
})

o.on(<span class="hljs-string">'close'</span>, () =&gt; {
  debug(<span class="hljs-string">'order closed: %s'</span>, o.status)
  closed = <span class="hljs-literal">true</span>
})

debug(<span class="hljs-string">'submitting order %d'</span>, o.cid)

o.submit().then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  debug(<span class="hljs-string">'got submit confirmation for order %d [%d]'</span>, o.cid, o.id)
}).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
  debug(<span class="hljs-string">'failed to submit order: %s'</span>, err.message)
})
</code></pre><p>The order book model constructor takes either entire book snapshots as returned by the WSv2 API, or individual update packets with single bids/asks. Once constructed, order books may be updated either with complete snapshots via <code>updateFromSnapshot(snapshot)</code> or individual update packets via <code>updateWidth(entry)</code>.</p><p>Static helpers are also provided for working with array-format order books, in the form of <code>updateArrayOBWith(ob, entry, raw)</code>, <code>arrayOBMidPrice(ob, raw)</code>, and <code>checksumArr(ob, raw)</code>.</p><p>Checksums may be calculated for normal books via <code>checksum()</code>, for comparison with the checksums reported by the WSv2 API.</p><p>Example usage:</p><pre><code class="hljs language-js"><span class="hljs-keyword">const</span> ob = <span class="hljs-keyword">new</span> OrderBook([
  [<span class="hljs-number">140</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>],
  [<span class="hljs-number">145</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>],
  [<span class="hljs-number">148</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>],
  [<span class="hljs-number">149</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>],
  [<span class="hljs-number">151</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-10</span>],
  [<span class="hljs-number">152</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-10</span>],
  [<span class="hljs-number">158</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-10</span>],
  [<span class="hljs-number">160</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-10</span>]
])

ob.updateWith([<span class="hljs-number">145</span>, <span class="hljs-number">3</span>, <span class="hljs-number">15</span>]) <span class="hljs-comment">// update bid</span>
ob.updateWith([<span class="hljs-number">158</span>, <span class="hljs-number">3</span>, <span class="hljs-number">-15</span>]) <span class="hljs-comment">// update ask</span>

<span class="hljs-built_in">console</span>.log(ob.serialize())
</code></pre><h3 id="contributing"><a class="header-anchor" href="#contributing">ยง</a> Contributing</h3><ol><li>Fork it</li><li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li><li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li><li>Push to the branch (<code>git push origin my-new-feature</code>)</li><li>Create a new Pull Request</li></ol></div></div><!--
      <div id="bfx-oss-docs-footer-bar">
        <div id="bfx-oss-docs-footer-bar__container">
          <p>Copyright ยฉ 2013-2020 iFinex Inc. All rights reserved.</p>
        </div>
      </div>
      --></div><script type="text/javascript" src="js/vendor/debug.min.js"></script><script type="text/javascript" src="js/vendor/lodash.min.js"></script><script type="text/javascript" src="js/vendor/zepto.min.js"></script><script type="text/javascript" src="js/vendor/perfect-scrollbar.min.js"></script><script type="text/javascript" src="js/main.js"></script></body></html>