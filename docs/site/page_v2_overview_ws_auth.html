<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width,initial-scale=1"><meta charset="utf-8"><link rel="stylesheet" type="text/css" href="css/normalize.css"><link rel="stylesheet" type="text/css" href="index.css"><link rel="stylesheet" type="text/css" href="css/highlightjs/ir-black.css"><title></title></head><body><div id="bfx-oss-docs-side-bar"><img id="bfx-oss-docs-side-bar__header" src="/img/bfx-logo-bg-white.png" alt="Bitfinex" height="64"><ul id="bfx-oss-docs-side-bar__main-menu"><li><a href="/index.html">Home</a></li><li><a href="/page_v2_overview_introduction.html">API v2 Overview</a></li><li><a href="/page_v2_reference.html">API v2 Reference</a></li><li><a href="/page_v1_overview_introduction.html">API v1 Overview</a></li><li><a href="/page_v1_reference.html">API v1 Reference</a></li><li><a href="/page_oss_projects.html">Open Source Projects</a></li></ul><div class="bfx-oss-docs-side-bar__sub-menu" id="bfx-oss-docs-side-bar__api-reference-menu"><h6>Authenticated Channels</h6><ul><li><a href="/page_v2_overview_abbreviations_glossary.html">Abbreviation Glossary</a></li><li><a href="/page_v2_overview_changelog.html">Changelog</a></li><li><a href="/page_v2_overview_derivatives.html">API Derivatives Trading</a></li><li><a href="/page_v2_overview_flag_values.html">Flag Values</a></li><li><a href="/page_v2_overview_honey_framework.html">Honey Framework</a></li><li><a href="/page_v2_overview_introduction.html">Introduction</a></li><li><a href="/page_v2_overview_open_source_libraries.html">Open Source Libraries</a></li><li><a href="/page_v2_overview_requirements_and_limitations.html">Requirements and Limitations</a></li><li><a href="/page_v2_overview_rest_auth.html">Authenticated Endpoints</a></li><li><a href="/page_v2_overview_rest_general.html">General</a></li><li><a href="/page_v2_overview_rest_public.html">Public Endpoints</a></li><li><a href="/page_v2_overview_rest_reading_the_api_documentation.html">Reading the Documentation (REST)</a></li><li><a href="/page_v2_overview_showcase.html">Showcase</a></li><li><a href="/page_v2_overview_ui_goodies.html">UI Goodies</a></li><li><a href="/page_v2_overview_ws_auth.html">Authenticated Channels</a></li><li><a href="/page_v2_overview_ws_general.html">General</a></li><li><a href="/page_v2_overview_ws_public.html">Public Channels</a></li><li><a href="/page_v2_overview_ws_reading_the_documentation.html">Reading the Documentation (WS)</a></li></ul></div></div><div id="bfx-oss-docs-content"><div id="bfx-oss-docs-header-bar"><h2>Documentation</h2><h2>Authenticated Channels</h2></div><div class="bfx-oss-docs-content-wrapper"><div class="bfx-oss-docs-md-content bfx-oss-docs-code-wrapper"><h3>URL</h3><p>Channels that require authentication should use the domain: wss://api.bitfinex.com/</p><p>The domain: wss://api-pub.bitfinex.com/ Should only be used for public channels.</p><h3>Account Information</h3><p>This channel allows you to keep up to date with the status of your account. You can receive updates on your positions, your balances, your orders and your trades. Once your session is authenticated it remains so until the connection is disconnected/terminated/restarted.</p><p>Account info always uses chanId 0.</p><p>To learn more, look to the <a href="ref:ws-auth-account-info">Account Info</a> channel page.</p><h3>Authenticating your Connection</h3><p>** Request parameters **</p><p>Below are the parameters that are used to authenticate a connection. The dms and filter parameters are optional.</p><p>Note:</p><ul><li><code>dms: 4</code> -&gt; when socket is closed, cancel all account orders</li></ul><p>Below is the example code to authenticate your connection. The optional parameters ‘dms’ and 'filter’are not used, but can be appended to the payload if desired.</p><div class="bfx-oss-docs-grouped-code-fence__container bfx-oss-docs-code-wrapper"><ul class="bfx-oss-docs-grouped-code-fence__navigation-bar"><li><input type="radio" style="display: none;" class="bfx-oss-docs-grouped-code-fence__label-radio" id="label-group-2-0" name="label-group-2" checked=""><label for="group-2-0" onclick="this.previousElementSibling.click()">javascript</label></li><li><input type="radio" style="display: none;" class="bfx-oss-docs-grouped-code-fence__label-radio" id="label-group-2-6" name="label-group-2"><label for="group-2-6" onclick="this.previousElementSibling.click()">go</label></li><li><input type="radio" style="display: none;" class="bfx-oss-docs-grouped-code-fence__label-radio" id="label-group-2-12" name="label-group-2"><label for="group-2-12" onclick="this.previousElementSibling.click()">Request / Response</label></li></ul><input type="radio" style="display: none;" class="bfx-oss-docs-grouped-code-fence__fence-radio" id="group-2-0" name="group-2" checked=""><pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto-js'</span>) <span class="hljs-comment">// Standard JavaScript cryptography library</span>
<span class="hljs-keyword">const</span> WebSocket = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ws'</span>) <span class="hljs-comment">// Websocket library for Node</span>

<span class="hljs-keyword">const</span> apiKey = <span class="hljs-string">''</span> <span class="hljs-comment">// Users API credentials are defined here</span>
<span class="hljs-keyword">const</span> apiSecret = <span class="hljs-string">''</span>

<span class="hljs-keyword">const</span> authNonce = <span class="hljs-built_in">Date</span>.now() * <span class="hljs-number">1000</span> <span class="hljs-comment">// Generate an ever increasing, single use value. (a timestamp satisfies this criteria)</span>
<span class="hljs-keyword">const</span> authPayload = <span class="hljs-string">'AUTH'</span> + authNonce <span class="hljs-comment">// Compile the authentication payload, this is simply the string 'AUTH' prepended to the nonce value</span>
<span class="hljs-keyword">const</span> authSig = crypto.HmacSHA384(authPayload, apiSecret).toString(crypto.enc.Hex) <span class="hljs-comment">// The authentication payload is hashed using the private key, the resulting hash is output as a hexadecimal string</span>

<span class="hljs-keyword">const</span> payload = {
  apiKey, <span class="hljs-comment">//API key</span>
  authSig, <span class="hljs-comment">//Authentication Sig</span>
  authNonce, 
  authPayload,
  <span class="hljs-attr">event</span>: <span class="hljs-string">'auth'</span>, <span class="hljs-comment">// The connection event, will always equal 'auth'</span>
}

<span class="hljs-keyword">const</span> wss = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">'wss://api.bitfinex.com/ws/2'</span>) <span class="hljs-comment">// Create new Websocket</span>

wss.on(<span class="hljs-string">'open'</span>, () =&gt; wss.send(<span class="hljs-built_in">JSON</span>.stringify(payload)))

wss.on(<span class="hljs-string">'message'</span>, (msg) =&gt; {     <span class="hljs-comment">// The 'message' event is called whenever the ws recieves ANY message</span>
  <span class="hljs-keyword">let</span> response = <span class="hljs-built_in">JSON</span>.parse(msg)
  <span class="hljs-built_in">console</span>.log(msg)
})
</code></pre><input type="radio" style="display: none;" class="bfx-oss-docs-grouped-code-fence__fence-radio" id="group-2-6" name="group-2"><pre><code class="hljs language-go"><span class="hljs-keyword">package</span> main
<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"crypto/hmac"</span>
    <span class="hljs-string">"crypto/sha512"</span>
    <span class="hljs-string">"encoding/hex"</span>
    <span class="hljs-string">"encoding/json"</span>
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"time"</span>
    <span class="hljs-string">"golang.org/x/net/websocket"</span>
)
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    ws, err := websocket.Dial(<span class="hljs-string">"wss://api.bitfinex.com/ws/2"</span>, <span class="hljs-string">""</span>, <span class="hljs-string">"http://localhost/"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span>
    }
    nonce := fmt.Sprintf(<span class="hljs-string">"%v"</span>, time.Now().Unix())
    payload := <span class="hljs-string">"AUTH"</span> + nonce
    sig := hmac.New(sha512.New384, []<span class="hljs-keyword">byte</span>(<span class="hljs-string">"API_SECRET"</span>))
    sig.Write([]<span class="hljs-keyword">byte</span>(payload))
    payload_sign := hex.EncodeToString(sig.Sum(<span class="hljs-literal">nil</span>))
    connectMsg, _ := json.Marshal(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">interface</span>{}{
        <span class="hljs-string">"event"</span>:       <span class="hljs-string">"auth"</span>,
        <span class="hljs-string">"apiKey"</span>:      <span class="hljs-string">"API_KEY"</span>,
        <span class="hljs-string">"authSig"</span>:     payload_sign,
        <span class="hljs-string">"authPayload"</span>: payload,
        <span class="hljs-string">"authNonce"</span>:   nonce,
    })
    <span class="hljs-comment">// Send auth message</span>
    _, err = ws.Write(connectMsg)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err)
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-comment">// Read all incoming messages</span>
    <span class="hljs-keyword">var</span> msg <span class="hljs-keyword">string</span>
    <span class="hljs-keyword">for</span> {
        <span class="hljs-keyword">if</span> err = websocket.Message.Receive(ws, &amp;msg); err != <span class="hljs-literal">nil</span> {
            fmt.Println(err)
        } <span class="hljs-keyword">else</span> {
            fmt.Println(msg)
        }
    }
}
</code></pre><input type="radio" style="display: none;" class="bfx-oss-docs-grouped-code-fence__fence-radio" id="group-2-12" name="group-2"><pre><code class="hljs language-text">// request
{
    event: &quot;auth&quot;,
    apiKey: api_key,
    authSig: signature,
    authPayload: payload,
    authNonce: +authNonce,
    calc: 1
}

// response
{ event: 'auth',
  status: 'OK',
  chanId: 0,
  userId: 269312,
  caps: '{&quot;orders&quot;: {&quot;read&quot;: &quot;1&quot;, &quot;write&quot;: &quot;0&quot;}, &quot;account&quot;: {&quot;read&quot;: &quot;1&quot;, &quot;write&quot;: &quot;0&quot;}, &quot;funding&quot;: {&quot;read&quot;: &quot;1&quot;, &quot;write&quot;: &quot;1&quot;}, &quot;history&quot;: {&quot;read&quot;: &quot;1&quot;, &quot;write&quot;: &quot;0&quot;}, &quot;wallets&quot;: {&quot;read&quot;: &quot;1&quot;, &quot;write&quot;: &quot;1&quot;}, &quot;withdraw&quot;: {&quot;read&quot;: &quot;0&quot;, &quot;write&quot;: &quot;1&quot;}, &quot;positions&quot;: {&quot;read&quot;: &quot;1&quot;, &quot;write&quot;: &quot;1&quot;}}' }

// response-failure
{  
   &quot;event&quot;:&quot;auth&quot;,
   &quot;status&quot;:&quot;FAIL&quot;,
   &quot;chanId&quot;:0,
   &quot;code&quot;:&quot;&lt;ERROR_CODE&gt;&quot;
}
</code></pre></div><div class="bfx-oss-docs-callout info"><div class="bfx-oss-docs-callout__marker"><p>!</p></div><div class="bfx-oss-docs-callout__content"><div class="bfx-oss-docs-callout__header"><p>WS Inputs</p><h6>info</h6></div><div class="bfx-oss-docs-callout__body"><p>Please note that the above example payload only authenticates your WS connection to the server. If you wish you interact with the API further you’ll have to include some sort of listener to perform some action on a particular Websocket “event”.</p><p>An example can be found here <a href="https://docs.bitfinex.com/reference#ws-input">https://docs.bitfinex.com/reference#ws-input</a>.</p></div></div></div><h3>Channel filters</h3><p>During authentication you can provide an array to indicate which informations/messages you are interested to receive (default = everything).</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> payload = {
  <span class="hljs-attr">event</span>: <span class="hljs-string">'auth'</span>, 
  <span class="hljs-comment">// ... </span>
  <span class="hljs-attr">filter</span>: [
    <span class="hljs-string">'trading'</span>, <span class="hljs-comment">// orders, positions, trades </span>
    <span class="hljs-string">'trading-tBTCUSD'</span>, <span class="hljs-comment">// tBTCUSD orders, positions, trades</span>
    <span class="hljs-string">'funding'</span>, <span class="hljs-comment">// offers, credits, loans, funding trades</span>
    <span class="hljs-string">'funding-fBTC'</span>, <span class="hljs-comment">// fBTC offers, credits, loans, funding trades</span>
    <span class="hljs-string">'wallet'</span>,  <span class="hljs-comment">// wallet</span>
    <span class="hljs-string">'wallet-exchange-BTC'</span>, <span class="hljs-comment">// Exchange BTC wallet changes</span>
    <span class="hljs-string">'algo'</span>,    <span class="hljs-comment">// algorithmic orders</span>
    <span class="hljs-string">'balance'</span>, <span class="hljs-comment">// balance (tradable balance, ...)</span>
    <span class="hljs-string">'notify'</span>   <span class="hljs-comment">// notifications</span>
  ]
}
</code></pre><h3>List of Account Info Events</h3><ul><li><a href="/v2/reference#ws-auth-orders">Orders</a></li><li><a href="ref:ws-auth-positions">Positions</a></li><li><a href="/v2/reference#ws-auth-trades">Trades</a></li><li><a href="ref:ws-auth-funding-offers">Funding Offers</a></li><li><a href="ref:ws-auth-funding-credits">Funding Credits</a></li><li><a href="ref:ws-auth-funding-loans">Funding Loans</a></li><li><a href="ref:ws-auth-wallets">Wallets</a></li><li><a href="ref:ws-auth-balance-info">Balance Info</a></li><li><a href="ref:ws-auth-margin-info">Margin Info</a></li><li><a href="ref:ws-auth-funding">Funding Info</a></li><li><a href="ref:ws-auth-funding-trades">Funding Trades</a></li><li><a href="ref:ws-auth-notifications">Notifications</a></li></ul><h3>List of WS Inputs</h3><ul><li><a href="ref:ws-auth-input-order-new">New Order</a></li><li><a href="ref:ws-auth-input-order-update">Update Order</a></li><li><a href="ref:ws-auth-input-order-multi-op">Order Multi-OP</a></li><li><a href="ref:ws-auth-input-order-cancel">Cancel Order</a></li><li><a href="ref:ws-auth-input-order-cancel-multi">Cancel Order Multi</a></li><li><a href="ref:ws-auth-input-offer-new">New Offer</a></li><li><a href="ref:ws-auth-input-offer-cancel">Cancel Offer</a></li><li><a href="ref:ws-auth-input-calc">Calc</a></li></ul></div></div><div id="bfx-oss-docs-footer-bar"><div id="bfx-oss-docs-footer-bar__container"><p>Copyright © 2013-2020 iFinex Inc. All rights reserved.</p></div></div></div><script type="text/javascript" src="js/vendor/zepto.min.js"></script><script type="text/javascript" src="js/vendor/lodash.min.js"></script><script type="text/javascript" src="js/vendor/debug.min.js"></script><script type="text/javascript" src="js/debug_init.js"></script></body></html>