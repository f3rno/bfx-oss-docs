<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width,initial-scale=1"><meta charset="utf-8"><link rel="stylesheet" type="text/css" href="css/normalize.css"><link rel="stylesheet" type="text/css" href="css/perfect-scrollbar.css"><link rel="stylesheet" type="text/css" href="css/highlightjs/night-owl.css"><link rel="stylesheet" type="text/css" href="index.css"><title>README | caron</title></head><body><div id="bfx-oss-docs-side-bar"><div id="bfx-oss-docs-side-bar__header"><img src="img/bfx-logo-bg-white.png" alt="Bitfinex" height="63"></div><ul><li><a href="index.html"><p>Home</p></a></li><li><a href="page_md_render_test.html"><p>Markdown Render Test</p></a></li><li><a href="/page_libraries_bitfinex_api_py_README.html"><img src="/svg/icons/python.svg"><p>bitfinex-api-py</p></a></li><li><a href="/page_libraries_bitfinex_api_go_README.html"><img src="/svg/icons/go.svg"><p>bitfinex-api-go</p></a></li><li><a href="/page_libraries_bfxfixgw_README.html"><img src="/svg/icons/go.svg"><p>bfxfixgw</p></a></li><li><a href="/page_libraries_bitfinex_api_rb_README.html"><img src="/svg/icons/ruby.svg"><p>bitfinex-api-rb</p></a></li><li><a href="/page_libraries_bitfinex_api_node_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bitfinex-api-node</p></a></li><li><a href="/page_libraries_bfx_api_mock_srv_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-mock-srv</p></a></li><li><a href="/page_libraries_bfx_api_node_core_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-core</p></a></li><li><a href="/page_libraries_bfx_api_node_models_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-models</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_example_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-example</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_managed_candles_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-managed-candles</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_managed_ob_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-managed-ob</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_ob_checksum_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-ob-checksum</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_seq_audit_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-seq-audit</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_wd_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-wd</p></a></li><li><a href="/page_libraries_bfx_api_node_rest_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-rest</p></a></li><li><a href="/page_libraries_bfx_api_node_util_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-util</p></a></li><li><a href="/page_libraries_bfx_api_node_ws1_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-api-node-ws1</p></a></li><li><a href="/page_libraries_bfx_hf_backtest_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-backtest</p></a></li><li><a href="/page_libraries_bfx_hf_chart_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-chart</p></a></li><li><a href="/page_libraries_bfx_hf_data_server_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-data-server</p></a></li><li><a href="/page_libraries_bfx_hf_ext_plugin_bitfinex_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-ext-plugin-bitfinex</p></a></li><li><a href="/page_libraries_bfx_hf_ext_plugin_dummy_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-ext-plugin-dummy</p></a></li><li><a href="/page_libraries_bfx_hf_indicators_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-indicators</p></a></li><li><a href="/page_libraries_bfx_hf_models_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-models</p></a></li><li><a href="/page_libraries_bfx_hf_models_adapter_lowdb_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-lowdb</p></a></li><li><a href="/page_libraries_bfx_hf_models_adapter_sql_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-sql</p></a></li><li><a href="/page_libraries_bfx_hf_models_adapter_template_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-template</p></a></li><li><a href="/page_libraries_bfx_hf_algo_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-algo</p></a></li><li><a href="/page_libraries_bfx_hf_server_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-server</p></a></li><li><a href="/page_libraries_bfx_hf_strategy_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-strategy</p></a></li><li><a href="/page_libraries_bfx_hf_strategy_exec_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-strategy-exec</p></a></li><li><a href="/page_libraries_bfx_hf_ui_config_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-ui-config</p></a></li><li><a href="/page_libraries_bfx_hf_util_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-hf-util</p></a></li><li><a href="/page_libraries_bfx_ws2_api_audit_README.html"><img src="/svg/icons/nodejs_small.svg"><p>bfx-ws2-api-audit</p></a></li><li><a href="/page_libraries_cbq_js_README.html"><img src="/svg/icons/nodejs_small.svg"><p>cbq-js</p></a></li><li class="active"><a href="/page_libraries_caron_README.html"><img src="/svg/icons/nodejs_small.svg"><p>caron</p></a><ul><li class="active"><a href="page_libraries_caron_README.html"><p>- README</p></a></li><li><a href="page_libraries_caron_reference.html"><p>- API Reference</p></a></li></ul></li><li><a href="/page_libraries_eos_name_verify_README.html"><img src="/svg/icons/nodejs_small.svg"><p>eos-name-verify</p></a></li><li><a href="/page_libraries_grenache_browser_http_README.html"><img src="/svg/icons/nodejs_small.svg"><p>grenache-browser-http</p></a></li><li><a href="/page_libraries_grenache_grape_README.html"><img src="/svg/icons/nodejs_small.svg"><p>grenache-grape</p></a></li><li><a href="/page_libraries_grenache_nodejs_base_README.html"><img src="/svg/icons/nodejs_small.svg"><p>grenache-nodejs-base</p></a></li><li><a href="/page_libraries_grenache_nodejs_http_README.html"><img src="/svg/icons/nodejs_small.svg"><p>grenache-nodejs-http</p></a></li><li><a href="/page_libraries_grenache_nodejs_link_README.html"><img src="/svg/icons/nodejs_small.svg"><p>grenache-nodejs-link</p></a></li><li><a href="/page_libraries_grenache_nodejs_utp_README.html"><img src="/svg/icons/nodejs_small.svg"><p>grenache-nodejs-utp</p></a></li><li><a href="/page_libraries_grenache_nodejs_ws_README.html"><img src="/svg/icons/nodejs_small.svg"><p>grenache-nodejs-ws</p></a></li><li><a href="/page_libraries_grenache_nodejs_ws_tls_README.html"><img src="/svg/icons/nodejs_small.svg"><p>grenache-nodejs-ws-tls</p></a></li><li><a href="/page_libraries_lib_js_util_currencies_README.html"><img src="/svg/icons/nodejs_small.svg"><p>lib-js-util-currencies</p></a></li><li><a href="/page_libraries_lib_js_util_math_README.html"><img src="/svg/icons/nodejs_small.svg"><p>lib-js-util-math</p></a></li><li><a href="/page_libraries_lib_js_util_number_README.html"><img src="/svg/icons/nodejs_small.svg"><p>lib-js-util-number</p></a></li><li><a href="/page_libraries_lib_js_util_symbol_README.html"><img src="/svg/icons/nodejs_small.svg"><p>lib-js-util-symbol</p></a></li><li><a href="/page_libraries_smidgen_README.html"><img src="/svg/icons/nodejs_small.svg"><p>smidgen</p></a></li><li><a href="/page_libraries_sunbeam_README.html"><img src="/svg/icons/nodejs_small.svg"><p>sunbeam</p></a></li><li><a href="/page_libraries_wasteland_README.html"><img src="/svg/icons/nodejs_small.svg"><p>wasteland</p></a></li></ul></div><div id="bfx-oss-docs-content"><div id="bfx-oss-docs-header-bar"><h2>README</h2><h2>caron</h2></div><div id="bfx-oss-docs-content-wrapper" class="bfx-oss-docs-content-type-api-docs"><div class="bfx-oss-docs-md-content bfx-oss-docs-code-wrapper"><div id="bfx-oss-docs-api-docs-index"><div id="bfx-oss-docs-api-docs-index__inner"><nav class="bfx-oss-docs-md-toc"><ol><li><a href="#caron">caron</a><ol><li><a href="#support">Support</a></li><li><a href="#install">Install</a></li><li><a href="#usage">Usage</a><ol><li><a href="#examples">Examples</a><ol><li><a href="#push-from-redis-cli">Push from redis-cli</a></li><li><a href="#push-from-node.js">Push from Node.js</a></li><li><a href="#push-from-ruby">Push from Ruby</a></li></ol></li></ol></li></ol></li></ol></nav></div></div><h1 id="caron"><a class="header-anchor" href="#caron">§</a> caron</h1><p>Atomic Job enqueuer from Redis lists to popular Job Queues (Sidekiq, Bull, …)</p><p><strong>Caron</strong> pops messages from a redis list and atomically creates a Job for the specified Job Queue.</p><p>Uses <code>lua</code> scripting internally to provide atomicity (<a href="http://redis.io/commands/EVAL">http://redis.io/commands/EVAL</a>)</p><h2 id="support"><a class="header-anchor" href="#support">§</a> Support</h2><ul><li><a href="https://github.com/mperham/sidekiq">Sidekiq-5.0.4</a></li><li><a href="https://github.com/OptimalBits/bull">Bull-3.2.0</a></li></ul><h2 id="install"><a class="header-anchor" href="#install">§</a> Install</h2><pre><code class="hljs">npm <span class="hljs-keyword">install</span> -g caron
</code></pre><h2 id="usage"><a class="header-anchor" href="#usage">§</a> Usage</h2><pre><code class="hljs">$ caron --<span class="hljs-keyword">help</span>

  Usage: caron [<span class="hljs-keyword">options</span>]

  Option<span class="hljs-variable">s:</span>

    -h, --<span class="hljs-keyword">help</span>            output usage information
    -V, --<span class="hljs-keyword">version</span>         output the <span class="hljs-keyword">version</span> <span class="hljs-keyword">number</span>
    -t, --<span class="hljs-built_in">type</span> <span class="hljs-symbol">&lt;val&gt;</span>      queue <span class="hljs-built_in">type</span> [sidekiq | bull]
    -<span class="hljs-keyword">l</span>, --<span class="hljs-keyword">list</span> <span class="hljs-symbol">&lt;val&gt;</span>      <span class="hljs-keyword">source</span> redis <span class="hljs-keyword">list</span> (i.<span class="hljs-keyword">e</span>: global_jobs)
    -r, --redis <span class="hljs-symbol">&lt;val&gt;</span>     redis url (i.<span class="hljs-keyword">e</span>: <span class="hljs-keyword">redi</span><span class="hljs-variable">s:</span>//<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">6379</span>)
    -<span class="hljs-keyword">f</span>, --freq <span class="hljs-symbol">&lt;n&gt;</span>        poll frequency (in milliseconds) - defaul<span class="hljs-variable">t:</span> <span class="hljs-number">10</span>
    -<span class="hljs-keyword">b</span>, --batch <span class="hljs-symbol">&lt;n&gt;</span>       <span class="hljs-built_in">max</span> <span class="hljs-keyword">number</span> of jobs created per batch - defaul<span class="hljs-variable">t:</span> <span class="hljs-number">1000</span>
    --q_prefix <span class="hljs-symbol">&lt;val&gt;</span>      redis queue prefix (i.<span class="hljs-keyword">e</span>: <span class="hljs-string">"bull"</span>)
    --def_queue <span class="hljs-symbol">&lt;val&gt;</span>     default dest queue - defaul<span class="hljs-variable">t:</span> default
    --def_worker <span class="hljs-symbol">&lt;val&gt;</span>    default Job Queue worker - defaul<span class="hljs-variable">t:</span> BaseJob
    --def_attempts <span class="hljs-symbol">&lt;val&gt;</span>  default Bull Job attempts - defaul<span class="hljs-variable">t:</span> <span class="hljs-number">1</span>
    --q_lifo              Bull LIFO <span class="hljs-keyword">mode</span>

</code></pre><pre><code class="hljs"><span class="hljs-string">caron </span><span class="hljs-built_in">--type</span> <span class="hljs-string">sidekiq </span><span class="hljs-built_in">--list</span> <span class="hljs-string">sidekiq_jobs </span><span class="hljs-built_in">--redis</span> <span class="hljs-string">"redis://127.0.0.1:6379"</span> <span class="hljs-built_in">--freq</span> <span class="hljs-string">25
</span></code></pre><p>Debug mode:</p><pre><code class="hljs"><span class="hljs-built_in">DEBUG</span>=caron:* caron -t <span class="hljs-keyword">bull </span>-l <span class="hljs-keyword">bull_test
</span></code></pre><h3 id="examples"><a class="header-anchor" href="#examples">§</a> Examples</h3><h5 id="push-from-redis-cli"><a class="header-anchor" href="#push-from-redis-cli">§</a> Push from redis-cli</h5><pre><code class="hljs language-bash">// Sidekiq job enqueue
redis-cli &gt; lpush <span class="hljs-string">"sidekiq_jobs"</span> <span class="hljs-string">"{\"<span class="hljs-variable">$queue</span>\":\"critical\",\"<span class="hljs-variable">$class</span>\":\"BackendJob\",\"foo\":\"bar\",\"my\":\"stuff\",\"other\":\"stuff\",\"other\":{\"f\":5}}"</span>

// Bull job enqueue
redis-cli &gt; lpush <span class="hljs-string">"bull_jobs"</span> <span class="hljs-string">"{\"<span class="hljs-variable">$queue</span>\":\"critical\",\"<span class="hljs-variable">$attempts</span>\":4,\"foo\":\"bar\",\"my\":\"stuff\",\"other\":{\"f\":5}}"</span>
</code></pre><h5 id="push-from-node.js"><a class="header-anchor" href="#push-from-node.js">§</a> Push from Node.js</h5><pre><code class="hljs language-js"><span class="hljs-meta">'use strict'</span>

<span class="hljs-keyword">const</span> Redis = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ioredis'</span>)

<span class="hljs-keyword">var</span> redis = <span class="hljs-keyword">new</span> Redis()

redis.lpush(<span class="hljs-string">'sidekiq_test'</span>, <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span>, <span class="hljs-string">'$queue'</span>: <span class="hljs-string">'critical'</span>, <span class="hljs-string">'$class'</span>: <span class="hljs-string">'MyCriticalJob'</span>, <span class="hljs-attr">other</span>: { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> } }))
redis.lpush(<span class="hljs-string">'bull_test'</span>, <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span>, <span class="hljs-string">'$queue'</span>: <span class="hljs-string">'priority'</span>, <span class="hljs-string">'$attempts'</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">other</span>: { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> } }))
redis.lpush(<span class="hljs-string">'bull_test'</span>, <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span>, <span class="hljs-string">'$queue'</span>: <span class="hljs-string">'lazy'</span>, <span class="hljs-string">'$attempts'</span>: <span class="hljs-number">1</span>, <span class="hljs-string">'$delay'</span>: <span class="hljs-number">5000</span>, <span class="hljs-attr">other</span>: { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> } }))
</code></pre><h5 id="push-from-ruby"><a class="header-anchor" href="#push-from-ruby">§</a> Push from Ruby</h5><pre><code class="hljs language-ruby"><span class="hljs-keyword">require</span> <span class="hljs-string">'redis'</span>
<span class="hljs-keyword">require</span> <span class="hljs-string">'json'</span>

rcli = Redis.new

rcli.lpush(<span class="hljs-string">'sidekiq_test'</span>, JSON.dump({ <span class="hljs-string">'foo'</span> =&gt; <span class="hljs-string">'bar'</span>, <span class="hljs-string">'$queue'</span> =&gt; <span class="hljs-string">'critical'</span>, <span class="hljs-string">'$class'</span> =&gt; <span class="hljs-string">'MyCriticalJob'</span>, <span class="hljs-string">'other'</span> =&gt; { <span class="hljs-string">'a'</span> =&gt; <span class="hljs-number">1</span>, <span class="hljs-string">'b'</span> =&gt; <span class="hljs-number">2</span> } }))
rcli.lpush(<span class="hljs-string">'bull_test'</span>, JSON.dump({ <span class="hljs-string">'foo'</span> =&gt; <span class="hljs-string">'bar'</span>, <span class="hljs-string">'$queue'</span> =&gt; <span class="hljs-string">'priority'</span>, <span class="hljs-string">'$attempts'</span> =&gt; <span class="hljs-number">5</span>, <span class="hljs-string">'other'</span> =&gt; { <span class="hljs-string">'a'</span> =&gt; <span class="hljs-number">1</span>, <span class="hljs-string">'b'</span> =&gt; <span class="hljs-number">2</span> } }))
rcli.lpush(<span class="hljs-string">'bull_test'</span>, JSON.dump({ <span class="hljs-string">'foo'</span> =&gt; <span class="hljs-string">'bar'</span>, <span class="hljs-string">'$queue'</span> =&gt; <span class="hljs-string">'lazy'</span>, <span class="hljs-string">'$attempts'</span> =&gt; <span class="hljs-number">1</span>, <span class="hljs-string">'$delay'</span> =&gt; <span class="hljs-number">5000</span>, other =&gt; { <span class="hljs-string">'a'</span> =&gt; <span class="hljs-number">1</span>, <span class="hljs-string">'b'</span> =&gt; <span class="hljs-number">2</span> } }))
</code></pre></div></div><!--
      <div id="bfx-oss-docs-footer-bar">
        <div id="bfx-oss-docs-footer-bar__container">
          <p>Copyright © 2013-2020 iFinex Inc. All rights reserved.</p>
        </div>
      </div>
      --></div><script type="text/javascript" src="js/vendor/debug.min.js"></script><script type="text/javascript" src="js/vendor/lodash.min.js"></script><script type="text/javascript" src="js/vendor/zepto.min.js"></script><script type="text/javascript" src="js/vendor/perfect-scrollbar.min.js"></script><script type="text/javascript" src="js/main.js"></script></body></html>